
[ann@cen7 madlib_demos]$ 
[ann@cen7 madlib_demos]$ ./psqlmad -f demo13.sql
DROP TABLE
CREATE TABLE
COPY 16767
DROP TABLE
SELECT 16767
   cdate    |   closep    |    leadp    
------------+-------------+-------------
 2016-08-10 |  2175.48999 | 2185.790039
 2016-08-11 | 2185.790039 | 2184.050049
 2016-08-12 | 2184.050049 | 2190.149902
 2016-08-15 | 2190.149902 | 2178.149902
 2016-08-16 | 2178.149902 | 2182.219971
 2016-08-17 | 2182.219971 |  2187.02002
 2016-08-18 |  2187.02002 | 2183.870117
 2016-08-19 | 2183.870117 |            
(8 rows)

DROP TABLE
SELECT 16767
   cdate    |   closep    |    leadp    |       pctlead       
------------+-------------+-------------+---------------------
 2016-08-09 |  2181.73999 |  2175.48999 |   -0.28646859977114
 2016-08-10 |  2175.48999 | 2185.790039 |   0.473458809157745
 2016-08-11 | 2185.790039 | 2184.050049 | -0.0796046266546297
 2016-08-12 | 2184.050049 | 2190.149902 |   0.279290898246268
 2016-08-15 | 2190.149902 | 2178.149902 |  -0.547907702072897
 2016-08-16 | 2178.149902 | 2182.219971 |   0.186858994243817
 2016-08-17 | 2182.219971 |  2187.02002 |   0.219961739136698
 2016-08-18 |  2187.02002 | 2183.870117 |  -0.144027168073203
 2016-08-19 | 2183.870117 |             |                    
(9 rows)

DROP TABLE
SELECT 16767
   cdate    |   closep    |    leadp    |       pctlead       |    mvgavg3day    |  mvgavg4day   |  mvgavg5day  | mvgavg10day  
------------+-------------+-------------+---------------------+------------------+---------------+--------------+--------------
 2016-07-29 | 2173.600098 | 2170.840088 |  -0.126978739214244 | 2170.08007833333 | 2169.85504175 | 2169.5800294 |  2169.179004
 2016-08-01 | 2170.840088 | 2157.030029 |  -0.636161966804434 | 2171.50008166667 | 2170.27008075 |  2170.052051 | 2169.5740235
 2016-08-02 | 2157.030029 | 2163.790039 |    0.31339433893435 | 2167.15673833333 |  2167.8825685 | 2167.6220704 | 2168.8990235
 2016-08-03 | 2163.790039 |     2164.25 |  0.0212571918582541 | 2163.88671866667 |  2166.3150635 | 2167.0640626 | 2167.9760254
 2016-08-04 |     2164.25 | 2182.870117 |   0.860349636132607 | 2161.69002266667 |   2163.977539 | 2165.9020508 | 2167.8840332
 2016-08-05 | 2182.870117 | 2180.889893 | -0.0907165288753599 | 2170.30338533333 | 2166.98504625 | 2167.7560546 |  2168.668042
 2016-08-08 | 2180.889893 |  2181.73999 |  0.0389793635491897 | 2176.00333666667 | 2172.95001225 | 2169.7660156 | 2169.9090333
 2016-08-09 |  2181.73999 |  2175.48999 |   -0.28646859977114 | 2181.83333333333 |     2177.4375 | 2174.7080078 | 2171.1650391
 2016-08-10 |  2175.48999 | 2185.790039 |   0.473458809157745 |      2179.373291 |  2180.2474975 |  2177.047998 | 2172.0560303
 2016-08-11 | 2185.790039 | 2184.050049 | -0.0796046266546297 |      2181.006673 |   2180.977478 | 2181.3560058 | 2173.6290283
 2016-08-12 | 2184.050049 | 2190.149902 |   0.279290898246268 | 2181.77669266667 |   2181.767517 | 2181.5919922 | 2174.6740234
 2016-08-15 | 2190.149902 | 2178.149902 |  -0.547907702072897 |       2186.66333 |   2183.869995 |  2183.443994 | 2176.6050048
 2016-08-16 | 2178.149902 | 2182.219971 |   0.186858994243817 | 2184.11661766667 |   2184.534973 | 2182.7259764 | 2178.7169921
 2016-08-17 | 2182.219971 |  2187.02002 |   0.219961739136698 | 2183.50659166667 |   2183.642456 | 2184.0719726 | 2180.5599853
 2016-08-18 |  2187.02002 | 2183.870117 |  -0.144027168073203 | 2182.46329766667 | 2184.38494875 | 2184.3179688 | 2182.8369873
 2016-08-19 | 2183.870117 |             |                     |      2184.370036 |  2182.8150025 | 2184.2819824 | 2182.9369873
(16 rows)

DROP TABLE
SELECT 16767
   cdate    |   closep    |    leadp    |       pctlead       |     mvgavg_slope3     |     mvgavg_slope4     |     mvgavg_slope5     |    mvgavg_slope10     
------------+-------------+-------------+---------------------+-----------------------+-----------------------+-----------------------+-----------------------
 2016-07-29 | 2173.600098 | 2170.840088 |  -0.126978739214244 |  0.000678955897239687 |  0.000589914752539336 | -0.000131816386638966 |  0.000546755614825978
 2016-08-01 | 2170.840088 | 2157.030029 |  -0.636161966804434 |  0.000653927368146029 |  0.000191238410224293 |  0.000217516257171134 |  0.000182072377213921
 2016-08-02 | 2157.030029 | 2163.790039 |    0.31339433893435 |  -0.00200416668370453 |  -0.00110131069122062 |  -0.00112103518098612 | -0.000311217808061191
 2016-08-03 | 2163.790039 |     2164.25 |  0.0212571918582541 |  -0.00151117876848997 | -0.000723581267753317 | -0.000257494833507749 | -0.000425741839017598
 2016-08-04 |     2164.25 | 2182.870117 |   0.860349636132607 |  -0.00101619380066811 |   -0.0010801981341636 | -0.000536502469985137 | -4.24340963776037e-05
 2016-08-05 | 2182.870117 | 2180.889893 | -0.0907165288753599 |   0.00396873668671147 |   0.00138787632854432 |  0.000855264039542589 |  0.000361516278571262
 2016-08-08 | 2180.889893 |  2181.73999 |  0.0389793635491897 |   0.00261945891225747 |    0.0027451004240192 |  0.000926349194129091 |  0.000571909366224619
 2016-08-09 |  2181.73999 |  2175.48999 |   -0.28646859977114 |   0.00267206324956084 |   0.00206090312580734 |   0.00227248540138483 |  0.000578493931774114
 2016-08-10 |  2175.48999 | 2185.790039 |   0.473458809157745 |  -0.00112878429018685 |   0.00128884335527142 |   0.00107484547981937 |  0.000410206360964924
 2016-08-11 | 2185.790039 | 2184.050049 | -0.0796046266546297 |  0.000748911968138661 |  0.000334703364598331 |   0.00197492192404416 |  0.000723673625774996
 2016-08-12 | 2184.050049 | 2190.149902 |   0.279290898246268 |  0.000352932391868818 |  0.000362109617016532 |  0.000108171647514173 |  0.000480529536268519
 2016-08-15 | 2190.149902 | 2178.149902 |  -0.547907702072897 |   0.00223474609295868 |  0.000962730384507273 |  0.000848202108727835 |  0.000887152880629217
 2016-08-16 | 2178.149902 | 2182.219971 |   0.186858994243817 |  -0.00116601481474626 |  0.000304402542517589 | -0.000328954531060261 |  0.000969372023836883
 2016-08-17 | 2182.219971 |  2187.02002 |   0.219961739136698 | -0.000279379051260229 | -0.000408728543240859 |  0.000616278317237593 |  0.000845192616770115
 2016-08-18 |  2187.02002 | 2183.870117 |  -0.144027168073203 | -0.000478035072166151 |  0.000339909295943921 |  0.000112619226465186 |   0.00104313882037373
 2016-08-19 | 2183.870117 |             |                     |  0.000872900791490979 | -0.000719230098841213 | -1.64751622225022e-05 |  4.58098426941498e-05
(16 rows)

      corr_sp3       |      corr_sp4       |      corr_sp5       |     corr_sp10      
---------------------+---------------------+---------------------+--------------------
 -0.0115591088455824 | -0.0129505909463748 | -0.0183539837009424 | -0.017942680610946
(1 row)

  yr  |       corr_sp3       |       corr_sp4       |       corr_sp5       |      corr_sp10       
------+----------------------+----------------------+----------------------+----------------------
 1950 | -0.00652617981623216 |  -0.0311235391516759 |  -0.0803626371991905 |   0.0067127806031092
 1951 |   0.0272762346562552 |   0.0443043182006665 |   0.0754380847939196 |   0.0270465536261156
 1952 |   0.0546452743761138 |   0.0413506195956893 |   0.0765670940724493 |   0.0752514091066325
 1953 |   0.0413076199522667 |    0.115152482257798 |    0.100526434046198 |   0.0288550893138595
 1954 |   0.0269827831792046 |   0.0242211639918068 |  -0.0472550922087133 | -0.00836842236709904
 1955 |  -0.0789059455984467 |  -0.0472712337736266 |  0.00153217021643924 |  -0.0265703502178904
 1956 |  -0.0323445307432909 |   0.0327077722848354 |   0.0338872500614501 |   0.0419959869118603
 1957 |  -0.0773948662527234 |  -0.0178169581424614 |   0.0146626067086643 |   0.0241298600711664
 1958 |  -0.0251125807071923 |   0.0149505373909574 | 0.000113017051239122 |  -0.0650535378699813
 1959 |  0.00646588403316578 |   0.0157914427019892 |   0.0225087586906468 |   0.0016819102904398
 1960 |     0.10073511497054 |   0.0878575647265506 |    0.102506378941023 |   0.0626431073621923
 1961 |   -0.107059948074249 | -0.00653807404351699 |  -0.0346907646281641 |  -0.0496834544613689
 1962 |   0.0597502740741842 |   0.0773425325035808 |   0.0405118005543901 |   0.0256936336837326
 1963 |  -0.0241392998314121 |  -0.0430498932043048 |  -0.0274614028247668 |   -0.025953596150414
 1964 |   0.0813905136571333 |   0.0901911330530845 |   0.0744469588685833 |    0.039761753496073
 1965 |   0.0886142421049611 |   0.0910963559406192 |   0.0794271648889804 |    0.022907896731037
 1966 |    0.100487313997336 |   0.0877233017961001 |   0.0966583627208727 |   0.0857431139172033
 1967 |   0.0951972429870703 |    0.162266557223406 |    0.159296687056807 |    0.107840417542722
 1968 |    0.183639338552346 |    0.212100561183176 |    0.198025611832955 |    0.112214626488845
 1969 |     0.15638243916783 |    0.163856717811855 |    0.163323048029033 |    0.133201118296172
 1970 |     0.19330488352709 |    0.182170834258333 |    0.176681554674025 |   0.0431379500768306
 1971 |    0.172345239494107 |    0.169529479878903 |    0.150481634151506 |    0.134915925874447
 1972 |     0.16853399054233 |    0.105877848002159 |   0.0899402731335954 |   0.0483126614979664
 1973 |   0.0246784723982741 | -0.00996758126739659 |  -0.0511553242082958 |  -0.0234533496224535
 1974 |    0.157231891141137 |    0.126655156169466 |   0.0620583131765813 |  -0.0597976736593069
 1975 |   0.0826300307354114 |   0.0734351264530207 |   0.0688525049075122 |  0.00479722503742585
 1976 |   0.0822035986884849 |   0.0461310889321631 |   0.0322810747461947 |  0.00499235639553968
 1977 |   0.0729654139620314 |   0.0586087656195319 |   0.0409985707252909 |  -0.0391249465603355
 1978 |     0.14691228306302 |    0.134187903913077 |     0.13232476069502 |    0.038276534718582
 1979 |   0.0424439455109364 |   0.0499620224854769 |   0.0508409243820318 |   0.0669878225815768
 1980 |   0.0580053846659547 |  -0.0117934886463007 |   0.0344161270286062 |   0.0449537558882733
 1981 |  0.00682568238727878 |  -0.0312649109155029 |  -0.0331903377401228 |  -0.0129426429146696
 1982 |    0.126986198859354 |     0.12320872615983 |   0.0902378398787064 |   0.0426636771647535
 1983 |  -0.0365670278711777 |  -0.0439369834345035 |  -0.0981053342354806 |   -0.121536513651691
 1984 |   0.0487956513677818 |   0.0187110665698586 |   0.0542966016096849 | -0.00512010504923214
 1985 |  -0.0134215850106118 | -0.00308007205621428 |   0.0198365401080591 |   0.0402872421972327
 1986 |   0.0186299285686038 |   0.0406028737872475 |      0.0212789108761 |  -0.0084889415873867
 1987 |   -0.099671330694985 |   -0.129882126650081 |  -0.0405815453672261 |  -0.0364903791438624
 1988 |  -0.0905002855546522 |  -0.0888235305525594 |    -0.11278617369416 |   -0.102758332080733
 1989 |  -0.0280045525451981 |   -0.113374067448413 |   -0.102435625784947 |  -0.0922534720109876
 1990 |  -0.0141024542557797 |  -0.0157091647768674 | 0.000980630060107923 |  -0.0387302809027088
 1991 |   0.0385764729866143 |   0.0644412363154256 |   0.0708615129350471 | -0.00764777803016153
 1992 |  -0.0750635626643298 |  -0.0812517811793968 |  -0.0819970198247761 |    -0.10353415603621
 1993 |   -0.037611155807835 |  -0.0554518806712403 |   -0.078068749338051 |   -0.195927580680508
 1994 |    0.015509547350657 |  -0.0302085224769627 |  -0.0524226995141711 |  -0.0734587836886829
 1995 |    -0.12273700373543 |    -0.10810976417722 |   -0.144605093655076 |   -0.170517103446415
 1996 |   0.0679826998353523 |   0.0392746967349377 |  0.00759376434374412 |  -0.0240525176276139
 1997 |   -0.108185103045512 |   -0.123699853191153 |   -0.126499415117783 | -0.00691795038144605
 1998 |    -0.02278519053558 |  0.00365670113299731 |  -0.0202111707962765 |  -0.0410380094888791
 1999 |  -0.0539460005053947 |   -0.073270776787123 |   -0.133936236441359 |  -0.0716293667768415
 2000 |    -0.11928615396906 |  -0.0728555695049144 |  -0.0700440786315122 |   -0.185816314510667
 2001 | -0.00415327862203688 |   0.0244262703992338 |  -0.0214414225290862 |   0.0193372225461312
 2002 |  -0.0509969795145137 |  -0.0777365441188193 |  -0.0623129432541629 |  -0.0626247482874611
 2003 |  -0.0536954750818493 |  0.00528736241912022 |  -0.0677176419750481 |  -0.0896180139968334
 2004 |  -0.0301268217519791 |  -0.0647781173239973 |  -0.0354101540366763 |  -0.0579371103740132
 2005 |  -0.0817533499793612 |  -0.0955703563187764 |  -0.0714673901887888 |  -0.0806947753323712
 2006 |  -0.0738262387730106 |  -0.0440855303138367 |  -0.0648138284620615 |    -0.14894522157487
 2007 |  -0.0636561585892884 |   -0.104486689773762 |    -0.11012816013639 |  -0.0766627079631863
 2008 |   -0.144488834381547 |   -0.190117651646435 |   -0.209005951750219 |   -0.115247260539285
 2009 |  -0.0697848116117085 | -0.00518637147778764 | -0.00237957303222752 |  -0.0287643293278497
 2010 |  -0.0279496946929153 |  -0.0266983771572355 |  -0.0327305924363609 |  -0.0497055250160676
 2011 |   -0.110119427057957 |  -0.0434157875766819 |   -0.135780036394432 |  -0.0856470813066342
 2012 |  -0.0223530309835443 |   -0.080904846673156 |    -0.12267127125257 |   -0.019481742424416
 2013 |  -0.0698059629759647 |  -0.0731584993935212 |   -0.109041116829674 |  -0.0481638565895552
 2014 |   0.0495709900135701 |   0.0265628565859321 |    0.016044942123202 |  -0.0476507686009631
 2015 |    -0.06517290987127 |   -0.142699600181794 |   -0.141064919785056 |   -0.134257763807793
 2016 |  -0.0475344378423609 |   -0.014711189540363 |  -0.0196352621432125 |  -0.0272924135529607
(67 rows)

DROP TABLE
SELECT 7059
SELECT 412
DROP TABLE
DROP TABLE
 linregr_train 
---------------
 
(1 row)

   cdate    |       pctlead       |     prediction      
------------+---------------------+---------------------
 2016-08-01 |  -0.636161966804434 |  0.0360742275221598
 2016-08-02 |    0.31339433893435 |  0.0655488908583145
 2016-08-03 |  0.0212571918582541 |  0.0540867005901489
 2016-08-04 |   0.860349636132607 |   0.052799477945225
 2016-08-05 | -0.0907165288753599 |  0.0117886533223479
 2016-08-08 |  0.0389793635491897 |  0.0191916687247984
 2016-08-09 |   -0.28646859977114 | 0.00309362142901582
 2016-08-10 |   0.473458809157745 |  0.0367088715402647
 2016-08-11 | -0.0796046266546297 |  0.0143294162811006
 2016-08-12 |   0.279290898246268 |   0.038117359875216
 2016-08-15 |  -0.547907702072897 |  0.0190012889081197
 2016-08-16 |   0.186858994243817 |  0.0495066431412635
 2016-08-17 |   0.219961739136698 |   0.033757100279742
 2016-08-18 |  -0.144027168073203 |  0.0406508079321458
 2016-08-19 |                     |  0.0368876057760307
(15 rows)

DROP TABLE
SELECT 412
 lo_effectiveness | prediction_count 
------------------+------------------
 7.80188178526499 |              412
(1 row)

  effectiveness   | prediction_count 
------------------+------------------
 11.3934960848485 |              412
(1 row)

[ann@cen7 madlib_demos]$ 
[ann@cen7 madlib_demos]$ 
